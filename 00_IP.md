# 00_IP (Internet Protocol)

> 인터넷 프로토콜, IP

## 1. 개념

인터넷 상에서 정보를 교환하기 위한 프로토콜로, 흔히 IP 주소(IP Address)라는 의미로 더 많이 사용된다.

IP는 `네트워크 ID` + `호스트 ID`로 구성되어 있다.

- `네트워크 ID`: 모든 호스트를 직접 관리하기 힘들기 때문에 만들어진 네트워크 범위를 지정한 ID
  - 네트워크 ID를 비유로 예를 들면 전세계에 존재하는 호스트들을 직접 관리하기 힘드니 각 국가를 의미한다고 보면 된다.
- `호스트 ID`: 각 네트워크의 호스트를 관리하기 위해 사용하는 ID
  - 그리고 호스트 ID는 호스트들을 개별적으로 관리하기 위해 사용하는 것으로, 비유를 하면 각 국가의 국민이라고 보면 된다.

<br>

다음과 같은 사설  IP가 있을 때, IP의 구조는 아래 그림과 같다.

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/2d289f9c-f6da-4efd-965b-0ab70e24ccb2)

그리고 192.168.10.~으로 시작하는 디바이스는 192.168.10.10, 192.168.10.25, 192.168.10.126과 모두 같은 네트워크에 속한다.

<br>

## 2. IPv4, IPv6

IP의 종류에는 `IPv4`와 `IPv6`가 있다.

### 1) IPv4

`32bit` 주소 체계의 프로토콜로, 일반적으로 현재 사용되고 있는 IP address 체계는 IPv4를 뜻한다.

- 예) 192.184.216.34

### 2) IPv6

`128bit` 주소 체계의 프로토콜로, IPv4만으로는 주소를 부여하기에 부족하기 때문에 생겨났다.

- 예) 2001:0db8:85a3:08d3:1319:8a2e:0370:7334

### 3) 특징 비교 요약

| 구분      | IPv4                                              | IPv6                                                         |
| --------- | ------------------------------------------------- | ------------------------------------------------------------ |
| 주소 체계 | 32 bit                                            | 128 bit                                                      |
| 표시 방법 | 8 bit씩 4부분으로 나뉜 10진수<br />192.184.216.34 | 16 bit씩 8부분으로 나뉜 16진수<br />2001:0db8:85a3:08d3:1319:8a2e:0370:7334 |
| 주소 개수 | 약 43억개                                         | 4.3 x 10 ^ 38개                                              |
| 주소 할당 | A, B, C, D 등 클래스 단위                         | 네트워크 규모 및 단말기 수에 따른 순차 할당                  |
| 헤더 크기 | 가변 (20바이트 이상)                              | 고정                                                         |
| 보안      |                                                   | IPv4에 비해 강화된 보안                                      |

<br>

## 3. IP 주소 클래스

IPv4 클래스에 대한 이해

IPv4는 32bit라고 했다. 이를 8bit로 4등분하면 각각을 `옥텟(Octet)`이라고 부른다.

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/4c74fcfc-b398-44ad-b331-7e85d51b3c0e)

이 옥텟별로 IP의 클래스를 A, B, C로 나눌 수 있다. (D, E 클래스도 있지만, 보통 A, B, C를 많이 쓴다.)

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/e58f2186-89a9-4261-b53e-737df1937a6c)

### 1) A 클래스

- 처음 8bit가 네트워크 ID이며, 나머지 뒤의 24bit가 호스트 ID로 사용된다.
- A 클래스의 첫 번째 옥텟의 왼쪽 첫 비트는 `0`으로 고정이다. 따라서  A 클래스의 범위는 `0 ~ 127`이지만, `0.0.0.0`은 미지정 주소, `127.0.0.0`은 루프백 주소로 예약되어 있다.
  - 그래서 사실상 A 클래스의 유효 범위는 1 ~ 126이다.
-  호스트 ID의 대역이 24bit이기 때문에 호스트 주소의 개수는 1670만개로, 대규모 네트워크에 적합하다.

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/41fbd37b-211b-4901-9824-2a9c271a97b6)

<br>

### 2) B 클래스

- B 클래스의 경우 처음 16bit가 네트워크 ID이고, 나머지 뒤의 16bit가 호스트 ID이다.
- B 클래스의 첫 번째 옥텟의 왼쪽 두 비트는 `10`으로 고정되어 있다. 따라서 B 클래스의 범위는 128 ~ 191이다.
- 호스트 ID 대역이 16bit이기 때문에 호스트 주소의 개수는 약 65000개 이므로 중규모 네트워크에 적합하다.

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/f0281665-6e08-407b-8db2-451b4cb057eb)

<br>

### 3) C 클래스

- C 클래스의 경우 처음 24bit가 네트워크 ID이고, 나머지 뒤의 8bit가 호스트 ID이다.
- C 클래스의 첫 번째 옥텟의 왼쪽 세 비트는 `110`으로 고정되어 있다. 따라서 C 클래스의 범위는 192 ~ 223이다.
- 호스트 대역이 8bit이기 때문에 호스트 주소의 개수는 256개이므로 소규모 네트워크에 적합하다.

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/f60279e3-2b2d-48ac-85e8-2ddbe4e2ad95)

<br>

### 4) D 클래스, E 클래스

A, B, C 클래스 외에도 D, E 클래스가 있지만 잘 쓰이지 않는다.

#### (1) D 클래스

- D 클래스의 첫 번째 옥텟의 왼쪽 네 비트는 `1110`으로 고정되어 있다. 따라서 표현 범위는 224 ~ 239이다.
- 멀티캐스트용 대역으로 IP 주소로 할당되지 않는다.

#### (2) E 클래스

- E 클래스의 첫 번째 옥텟의 왼쪽 네 비트는 `1111`로 고정되어 있다. 따라서 표현 범위는 240 ~ 255이다.
- 연구용으로 예약된 주소 대역으로 IP 주소로 할당되지 않는다.

<br>

## 4. 네트워크 주소와 브로드캐스트 주소

IP 주소에는 **사용할 수 없는 주소**가 **두 개** 존재한다.

하나는 `네트워크 주소`이고, 다른 하나는 `브로드캐스트 주소`라고 부른다.

- 네트워크 주소는 해당 네트워크를 나타내는 주소로 네트워크 그 자체를 의미한다.
  - 네트워크 주소의 호스트 ID는 0이다.
- 브로드캐스트 주소는 인터넷에 데이터를 전달하기 위한 주소이다.
  - 브로드캐스트 주소의 호스트 ID는 255이다.

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/9d97954d-0c53-4bd4-a4ab-1008cd4e304e)

- 예를 들어 IP 주소의 범위가 192.168.1.0 ~ 192.168.1.255이라면, 우리가 실제 사용하는 주소는 192.168.1.1 ~ 192.168.1.254인셈이다.
- 그런데 보통 1번은 공유기(라우터)가 가져가므로 실제 사용자들은 2번부터 IP 주소를 할당받는다.

<br>

## 5. Public IP와 Private IP

공인 IP (Public IP)와 사설 IP (Private IP)

![image](https://github.com/siwon-park/Problem_Solving/assets/93081720/b14b01b4-3272-417e-8327-254332ca84d3)

| 항목      | Public IP                            | Private IP                             |
| --------- | ------------------------------------ | -------------------------------------- |
| 할당 주체 | ISP (인터넷 서비스 공급자)           | 라우터 (공유기)                        |
| 할당 대상 | 서버(라우터) - 개인 또는 회사        | 기기- 개인 또는 회사                   |
| 고유성    | 전체 인터넷 상에서 유일한 주소       | 하나의 네트워크 안에서만 유일          |
| 범위      | Private IP외 나머지 범위의 주소 사용 | 지정된 범위의 IP만 사설 IP로 사용 가능 |
| 공개 여부 | 내/외부 접근 가능                    | 외부 접근 불가능                       |

※ 사설IP 주소 대역

- Class A:  **10**.0.0.0 ~ **10**.255.255.255
- Class B: **172.16**.0.0 ~ **172.31**.255.255
- Class C: **192.168**.0.0 ~ **192.168**.255.255

위 대역을 제외한 모든 IP 주소 체계는 Public IP로 사용이 가능하다.

### 1) 과정

인터넷이 알 수 있는 IP 주소는 공유기(라우터)에 할당된 공인 IP(Public IP)주소까지만이다.

우리가 집에서 사용하는 스마트폰, 노트북 등 유무선 인터넷을 이용하는 디바이스는 `공유기가 새로 발급해준 IP 주소인 사설 IP(Private IP)를 할당받아 사용하는 것이다.`

- 따라서 Private IP 주소만으로는 인터넷에 접속할 수 없다. 반드시 해당 Private IP를 할당해준 Public IP가 필요하다.

인터넷은 사설 IP의 존재 유무를 알 수 없으며, 인터넷과 사설 IP 간에 데이터 패킷을 주고 받기 위해서는 공유기를 통해 공인 IP로 변환되어 패킷을 주고 받아야 한다.

- 사설 IP를 할당받은 디바이스가 데이터 패킷을 인터넷으로 전송하면, 공유기(라우터)가 해당 사설 IP를 공인 IP로 바꿔서 전송한다.
- 인터넷에서 오는 데이터 패킷의 목적지도 해당하는 사설 IP로 변경한 후 디바이스에 전송한다.

<br>

### 2) 등장 이유?

왜 이런 체계가 등장했을까? 그 이유는 바로 IPv4의 주소 체계가 32 bit 체계이기 때문이다.

처음에 IPv4라는 프로토콜 체계를 만들 땐, 32 bit인 43억 개 정도면 충분히 사용하고도 남을 것이라 생각했었지만, 기술의 발전에 따라 다양한 형태의 많은 인터넷 기기들이 보급되어 43억 개만으로는 모자라게 되었다.

따라서 이러한 한계를 극복하기 위해 전체 인터넷 상에서 유일한 Public IP와 하나의 네트워크 상에서만 유일한 Private IP로 나눠서 네트워크를 구성함으로써 많은 기기들이 Public IP 주소를 1:1로 할당받지 않아도 인터넷과 통신할 수 있는 것이다.

<br>

## 6. 고정 IP와 유동 IP

### 1) 고정 IP

디바이스에 고정적으로 부여된 IP로 한 번 부여되고 나면 해당 디바이스가 IP 주소를 반납하기 전까지는 다른 장비에 부여할 수 없다.

따라서 인터넷 상에서 서버를 통해 서비스를 운영하고자 한다면, 공인 IP(Public IP)를 고정 IP로 유지해야 한다. 그렇지 않으면 매번 우리의 서비스로 접근하고자 했을 때, 올바른 서비스로 접근하지 못하는 경우가 생기기 때문이다.

### 2) 유동 IP

장비에 고정적으로 IP를 부여하지 않고, 사용할 때 남아 있는 IP 중에서 돌아가면서 유동적으로 부여하는 IP를 말한다.

가정에서 사용하는 기기와 같이 사설망 내부에 존재하는 디바이스들은 공유기를 통해 Private IP를 유동 IP로 부여받는 것이 일반적이다.