# 05_컴포지션 패턴

> Composition Pattern

"상속(inherit)보다 조합(compose)을 사용하라"는 객체 지향 설계 원칙을 구현한 패턴.

한 클래스가 다른 클래스를 포함하는 관계(has-a 관계)를 재사용성을 높이는 방식을 말한다.

- 상속의 경우 is-a 관계라고 한다.

## 1. 개념

컴포지션 패턴의 경우 위에서 언급했듯이 상속과 항상 같이 논의되는 개념이다.

굳이 상속을 할 필요성이 없고, 다른 부분에도 조합해서 활용할 수 있는 재사용성이 요구되는, 객체 필드 간 중복이 많고 혼재되어있는 경우에 유용하게 사용할 수 있다.

### 1) 상속의 문제점

- 부모 클래스의 스펙 변경 시 자식 클래스에 영향
- 불필요한 메서드와 필드까지 상속 받으므로 낭비
- 자바의 경우 다중 상속이 불가하여 클래스 간 조합이 불가능
- 코드 간 결합도가 높아짐

### 2) 컴포지션의 장점

- 필요한 기능, 메서드, 필드만 조합해서 사용 가능하여 재사용성이 높음
- 런타임에 기능, 필드 변경이 가능하여 유연성이 높음
  - 인터페이스 타입으로 선언한 필드에 대해서 런타임에 다른 구현체로 교체하여 기능 변경이 가능
- 인터페이스를 통한 느슨한 연결 시 결합도를 낮출 수 있음

<br>

## 2. 예시

- DTO에 활용

```java
// 주소 DTO
public class AddressDTO {
    private String city;
    private String street;
    private String zipCode;
}

// 사용자 DTO - 컴포지션 패턴 사용
public class UserDTO {
    private String name;
    private String email;
    private AddressDTO address; // 다른 DTO를 조합
    private List<PhoneDTO> phones;
}
```

- 엔티티와 비즈니스 로직에 적용

```java
// 인터페이스를 활용한 결합도 감소
interface Engine {
    void start();  // 이것만 약속
}

class GasolineEngine implements Engine {
    private int cylinders;  // Car는 이게 있는지도 몰라도 됨
    private double fuelLevel;  // Car는 이것도 몰라도 됨
    
    public void start() { }
}

class Car {
    private Engine engine;  // 구현체가 뭔지 몰라도 됨
    
    public void drive() {
        engine.start();  // 인터페이스만 사용
    }
}
```

<br>