# 00_VPN

> Virtual Private Network; 가상 사설망

<br>

## 1. 등장 배경

### 1) 공인망과 사설망

IPv4 체계 기반의 공인망은 약 43억개의 네트워크 망을 가질 수 있다.(IP 주소의 개수) 43억이라는 숫자는 매우 크지만, 기술이 발전되고 네트워크 망에 대한 수요가 늘어나면서 43억 개만으로는 네트워크 구축에 한계를 가져왔다.

이에 등장하게 된 개념이 `사설망(Private Network)`이다. 사설망은 사설 IP와 밀접한 관련이 있는 개념으로 공인망 안에 LAN(Local Area Network)으로 사설망을 구축함으로써 부족한 네트워크 망에 대한 문제를 해결할 수 있었다.

### 2) 사설망과 전용 회선

사설망의 장점은

- IP 주소의 절약
- 외부와 내부를 구분하여 내부 네트워크를 보호 가능

이다.

특히 두 번째 이유로 다양한 곳에서 사설망 구축이 이루어졌고, 공인망 - 사설망이 아니라 `사설망 - 사설망 연결`의 필요성이 대두됨에 따라 `전용 회선(Leased Line)`이라는 개념이 등장했다.

기업의 경우, 회사에서 주고받는 데이터의 기밀성, 안전성을 유지하기 위해 본사의 사설망과 지사의 사설망을 연결하여 사용한다.

전용 회선이라는 것은 결국에 공인망이 아니라 `인터넷 서비스 공급자(ISP)의 망 일부를 독점해서 사용하는 것`을 말한다.

그런데 이 전용 회선의 가장 큰 문제점은 망 하나를 독점하는 만큼 `비용이 많이 든다`는 것이다.

이에 두 가지 숙제가 등장했는데,

- 전용 회선을 사용하지 않고 사설망과 사설망을 연결하는 방법?
  - 그렇게 하려면 공인망을 사용해야 하는데?
- 인터넷 프로토콜(IP)의 취약점인 데이터 암호화는 어떻게 해결하지?
  - 공인망을 사용해도 안전이 보장되는가?

### 3) VPN의 등장

위에서 제시한 두 가지 문제를 해결한 방법이 VPN이다. 따라서 VPN은 쉽게 말해서

- 공인망을 통한 사설망 간의 연결 방법
- 데이터 암호화를 해결한 네트워크 기술 혹은 장비를 말한다.

<br>

## 2. VPN

실제로 물리적으로 전용 회선이 구축된 것이 아니지만 `논리적으로는 구축되어 있는 것(가상화)과 같은 효과`를 내는 가상의 사설망.

`공인 네트워크 상에서 구축되는 논리적인 전용 네트워크`

### 1) 개념

사설망과 사설망이 공공망을 통해 통신을 할 수 있도록 지원하며 데이터 암호화를 제공하는 네트워크 기술 혹은 장비를 말한다.

그러나 착각하지 말아야 할 것이 데이터가 암호화 된다고 해도 안전한 것은 아니다. 왜냐하면 공공망을 이용해서 데이터를 주고 받기 때문에 아무래도 전용 회선을 사용하는 것보다 보안에 취약할 수밖에 없다.

또한 전용 회선의 경우 대역폭을 보장하지만, 공공 인터넷 망은 통신에 문제가 생기면 데이터를 제대로 전달하지 못한다는 단점도 존재한다.

### 2) 터널링(Tunneling)

VPN은 공인망에서 IP 패킷(IP Packet)을 캡슐화함과 동시에 데이터의 암호화/인증 방식을 협상하게 된다. 이러한 협상 과정까지 거치기 때문에 아무리 공인망이라고 해도 외부인이 쉽게 패킷을 탈취할 수 없는 것이다.

이 기술을 바로 `터널링(Tunneling)`이라고 하며, `터널링 프로토콜(Tunneling Protocol)`이라고 부른다.

패킷이 암호화되어 공인 인터넷 망에서 이동하는 특징 덕분에 마치 가상의 터널을 통해서 데이터를 주고 받는 것처럼 느껴져서 "VPN 터널이 뚫렸다"라고도 표현한다.

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/d94ba02f-4d49-414a-b51a-0e2fb30c4afd)

### 3) VPN 분류와 구현의 차이

VPN은 접속 방식, 터널링 프로토콜, 통신 계층, 운용 주체 등 기준에 따라 다양한 종류로 나뉜다.

#### (1) 접속 방식

- Site To Site (LAN To LAN) 방식
- Client To Site 방식

#### (2) 터널링 프로토콜

- PPTP / L2TP
- IPSpec
- SSL

#### (3) 통신 계층

- L2
- L3
- L4

#### (4) 운용 주체

- Core
- CPE

그러나 이러한 분류 방법은 어디까지나 VPN을 바라보는 관점이지, 완전히 명확하게 구분된 다른 VPN이 되는 것이 아님을 유의해야 한다.

예를 들어, 재택 근무를 위해 만들어진 VPN은 접속 방식으로는 Client To Site 방식이면서 터널링 프로토콜로는 SSL 기반의 VPN이며, 통신 계층으로 분류하면 L4 / L7 기반의 VPN이다. 