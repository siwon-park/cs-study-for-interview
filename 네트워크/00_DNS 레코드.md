# 00_DNS 레코드와 종류

DNS 레코드에는 여러 종류가 있다.

각 레코드별로 하는 역할 및 용도에 차이가 있다.

## 1. A 레코드

> Address

A 레코드의 A는 주소(address)를 의미한다.

A 레코드는 도메인 주소(호스트)와 IP 주소의 매칭을 의미하는 레코드이다.

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/806c87ed-e558-4c52-aa37-37324f1d56ca)

예를 들어, google.com이라는 도메인 주소가 있으면 해당 도메인에 해당하는 IP 주소는 121.34.57.789라고 맵핑되어 있는 것이다.

실제로 네트워크 상에서 통신은 IP를 통해서 이뤄지기 때문에 필요한 것은 IP이다. 그런데 IP를 일일이 다 외우면서 살 수는 없으니 보다 외우기 쉽고 이해 가능한 문자열인 도메인 주소라는 것을 사용하는 것이며, 이에 매칭되는 IP를 기록한 것이 A 레코드이다.

A 레코드와 IP는 반드시 1:1 매칭이 아니다. 경우에 따라 1:1, 1:多 매칭이 가능하다. 즉, 한 개의 도메인 주소에 여러 개의 IP 주소를 맵핑시키는 것이 가능하다.

### 1) CNAME

> Canonical Name Record

CNAME 레코드는 도메인 별칭 레코드라고 부르며, 도메인 주소에 또 다른 도메인 주소로 이중 맵핑하는 형태의 DNS 레코드이다.

이중 맵핑된 레코드이기 때문에 A레코드처럼 IP에 직접 맵핑되어서는 안 된다.

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/e182cf74-16f0-4aae-a197-9e9fbc2f9f55)

- A레코드 vs CNAME
  - A레코드는 몇 번의 요청으로 IP 주소를 찾기 쉽다. 그러나 반면에 IP 주소가 자주 바뀌는 환경이라면 A 레코드 사용은 불편함을 가져온다.
  - 반면 CNAME 레코드는 CNAME과 연결된 A레코드의 정보만 변경하면 다른 CNAME 레코드는 굳이 변경할 필요없이 사용하면 되므로, IP 주소가 자주 변경되는 환경에서 A레코드보다 유용하다.

### 2) AAAA

AAAA 레코드라는 것이 있는데, 이는 A레코드의 IPv6 버전이라고 이해하면 된다.

<br>

## 2. MX 레코드

> Mail Exchanger

MX 레코드는 메일 교환(Mail Exchanger)에 사용되는 메일 서버 레코드이다.

MX 레코드가 해당 도메인에 설정되어 있어야 그 도메인을 메일 주소로 사용 가능하다.

![image](https://github.com/siwon-park/cs-study-for-interview/assets/93081720/c866e1c0-b3cf-400e-825d-cb21b0705778)

해당 도메인의 mx 레코드가 존재하면 SMTP 프로토콜을 통해 메일을 주고 받는 것이 가능해진다.

<br>

## 3. PTR 레코드

> Pointer

PTR 레코드는 IP 주소에 대한 도메인 주소(호스트)를 확인할 수 있는 레코드이다. A 레코드의 반대 방향 레코드라고 보면 된다.

PTR 레코드는 1개의 IP에 1개의 도메인만 맵핑이 가능하다. (1:1맵핑)

PTR 레코드를 사용하는 이유는 크게 다음과 같다.

- 보안: IP 주소가 악의적인 활동과 연관되어 있을 때 해당 IP 주소의 호스트를 식별하는데 도움을 준다.
  - ex) 스팸 메일 발송자의 IP 주소를 식별하여 차단함
- 로깅, 모니터링: 네트워크 트래픽을 모니터링하고 로깅할 때 IP 주소로 이를 남기면 이해하기 어려우므로 보다 이해하기 쉬운 도메인 정보로 남길 수 있음

<br>

## 4. TXT 레코드

> Text

TXT 레코드는 글자 그대로 텍스트 레코드인데, Key와 Value 구조로 이루어져 있다.

주로 메모를 남기는 용도인데, SPF 레코드와도 연관이 있다.

### 1) SPF 레코드

> Sender Policy Framework

SPF 레코드는 TXT 레코드의 한 종류로 메일 송수신 정책과 관련된 DNS 레코드이다.

메일을 보내기 위해 사용하는 SMTP 프로토콜에는 도메인 인증 기능이 없어 보안적으로 취약하지만, SPF 레코드를 활용하여 도메인 인증을 하는 것이다.

SPF 레코드는 공식적으로 지원이 중단되어 SPF 레코드를 설정하려면 TXT 레코드 설정에서 해줘야 한다.

SPF 레코드를 등록하면, 메일을 수신하는 서버는 발신 메일 주소로부터 얻은 도메인 정보를 토대로 해당 DNS 레코드의 값이 SPF 레코드의 값과 비교하여 보안적인 조치를 취하게 된다. 이는 발신 역시 마찬가지이다.

- SPF 레코드에 등록된 주소로만 메일을 발신할 수 있다.
- 발신 메일 주소가 SPF 레코드에 등록된 메일 주소인지 확인하고 수신한다.

SPF 레코드가 없다면 공격자가 발신지 도메인 주소로 위장하여 스팸 메일을 보내 공격하는 것이 가능하게 된다.

SPF 레코드는 일반적으로 `v=spf1 ip4=XX.XXX.XXX include:OOO.com -all`과 같은 형태인데 의미는 다음과 같다.

- `v=spf1`: SPF 레코드임을 명시하는 예약어로, 모든 SPF 레코드는 이 문자열로 시작한다.
- `ip4=[IP주소]`: SPF로 승인할 IP 주소 목록을 작성하여 등록한다. 해당 IP 주소에서 메일을 보내는 게 가능하다는 의미이다.
- `include:[도메인주소]`: 해당 도메인으로 선언된 SPF 레코드를 가져온다. 해당 도메인에서 메일을 보낼 수 있는 제 3 조직을 서버에 알려주는 키워드이다.
- `-all / ~all`: 반드시 작성해야 하는 키워드로, `-all`은 SPF 검증에 실패한 메일을 차단하는 것이고, `~all`은 SPF 검증에 실패한 메일도 수신한다는 의미이다.

<br>

